<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PDF Converter</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      transition: background 0.3s, color 0.3s;
    }
    [data-theme="dark"] {
      background: #121212;
      color: #f1f1f1;
    }
    .container {
      max-width: 600px;
      margin: 2rem auto;
      padding: 1rem;
      text-align: center;
    }
    select, input, button {
      padding: 0.5rem;
      margin: 0.5rem;
      width: 90%;
      max-width: 400px;
    }
    .dropzone {
      border: 2px dashed #ccc;
      padding: 2rem;
      margin: 1rem auto;
      cursor: pointer;
      border-radius: 10px;
    }
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
    }
    .modal-content {
      background: #fff;
      margin: 5% auto;
      padding: 1rem;
      border-radius: 8px;
      width: 90%;
      max-width: 400px;
    }
    [data-theme="dark"] .modal-content {
      background: #222;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìÑ File Converter</h1>

    <label for="format">Choose Conversion Format:</label>
    <select id="format">
      <option value="">Select...</option>
      <option value="pdf-to-docx">PDF to DOCX</option>
      <option value="pdf-to-txt">PDF to TXT</option>
      <option value="pdf-to-jpg">PDF to JPG</option>
      <option value="pdf-to-pdf">PDF to PDF</option>
      <option value="docx-to-pdf">DOCX to PDF</option>
      <option value="pptx-to-pdf">PPTX to PDF</option>
      <option value="xlsx-to-pdf">XLSX to PDF</option>
      <option value="html-to-pdf">HTML to PDF</option>
      <option value="txt-to-pdf">TXT to PDF</option>
      <option value="jpg-to-pdf">JPG to PDF</option>
    </select>

    <div class="dropzone" id="dropzone">Drop files here or click to upload</div>
    <input type="file" id="file" multiple style="display: none;" />

    <button onclick="openSettings()">‚öôÔ∏è Settings</button>
    <button onclick="convertFiles()">üîÑ Convert</button>
    <button onclick="toggleDarkMode()">üåì Toggle Theme</button>

    <div id="status"></div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <h2>Settings</h2>
      <label>Output File Prefix: <input type="text" id="filename_prefix" value="converted_" /></label>
      <label>Page Size: 
        <select id="page_size">
          <option>A4</option>
          <option>Letter</option>
        </select>
      </label>
      <label>DPI (Image): <input type="number" id="dpi" value="150" /></label>
      <label>Compression:
        <select id="compression">
          <option value="low">Low</option>
          <option value="medium" selected>Medium</option>
          <option value="high">High</option>
        </select>
      </label>
      <button onclick="closeSettings()">Close</button>
    </div>
  </div>

  <script>
    function toggleDarkMode() {
      const theme = document.documentElement.getAttribute('data-theme');
      document.documentElement.setAttribute('data-theme', theme === 'dark' ? 'light' : 'dark');
    }

    function openSettings() {
      document.getElementById('settingsModal').style.display = 'block';
    }

    function closeSettings() {
      document.getElementById('settingsModal').style.display = 'none';
    }

    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('file');

    dropzone.addEventListener('click', () => fileInput.click());
    dropzone.addEventListener('dragover', e => {
      e.preventDefault();
      dropzone.style.borderColor = 'green';
    });
    dropzone.addEventListener('dragleave', () => {
      dropzone.style.borderColor = '#ccc';
    });
    dropzone.addEventListener('drop', e => {
      e.preventDefault();
      dropzone.style.borderColor = '#ccc';
      fileInput.files = e.dataTransfer.files;
    });

    function convertFiles() {
      const format = document.getElementById('format').value;
      const files = fileInput.files;

      if (!format || files.length === 0) {
        alert('Please select a format and upload at least one file.');
        return;
      }

      const formData = new FormData();
      for (let file of files) formData.append('file', file);
      formData.append('format', format);
      formData.append('filename_prefix', document.getElementById('filename_prefix').value);
      formData.append('page_size', document.getElementById('page_size').value);
      formData.append('dpi', document.getElementById('dpi').value);
      formData.append('compression', document.getElementById('compression').value);

      document.getElementById('status').textContent = 'Converting...';

      fetch('/convert', {
        method: 'POST',
        body: formData
      }).then(res => {
        if (!res.ok) throw new Error('Conversion failed.');
        return res.blob();
      }).then(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'output.zip';
        document.body.appendChild(a);
        a.click();
        a.remove();
        document.getElementById('status').textContent = 'Download started.';
      }).catch(err => {
        console.error(err);
        document.getElementById('status').textContent = 'Error during conversion.';
      });
    }
  </script>
</body>
</html>
